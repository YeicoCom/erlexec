<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.29.0">
    <meta name="project" content="erlexec v2.0.1">

      <meta name="author" content="Serge Aleynikov">

    <title>Overview — erlexec v2.0.1</title>
    <link rel="stylesheet" href="dist/html-erlang-4XYKNH4U.css" />

    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-X7YVL3G2.js"></script>
    <script src="dist/sidebar_items-C3382FBE.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/html-XN2TSG4M.js"></script>


  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

    <div class="sidebar-projectDetails">
      <a href="readme.html" class="sidebar-projectName" translate="no">
erlexec
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v2.0.1
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">Pages</a></li>

        <li><a id="modules-list-link" href="#full-list">Modules</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="settings display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>


    <a href="https://github.com/saleyn/erlexec/blob/v2.0.1/README.md#L1" title="View Source" class="view-source" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span>Erlexec - OS Process Manager for the Erlang VM</span>
</h1>

<p><a href="https://github.com/saleyn/erlexec/actions/workflows/erlang.yml"><img src="https://github.com/saleyn/erlexec/actions/workflows/erlang.yml/badge.svg" alt="build"/></a>
<a href="https://hex.pm/packages/erlexec"><img src="https://img.shields.io/hexpm/v/erlexec.svg" alt="Hex.pm"/></a>
<a href="https://hex.pm/packages/erlexec"><img src="https://img.shields.io/hexpm/dt/erlexec.svg" alt="Hex.pm"/></a></p><p><strong>Author</strong> Serge Aleynikov &lt;saleyn(at)gmail.com&gt;</p><h2 id="summary" class="section-heading">
  <a href="#summary" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">summary</p>
  </a>
  Summary
</h2>
<p>Execute and control OS processes from Erlang/OTP.</p><p>This project implements an Erlang application with a C++ port program
that gives light-weight Erlang processes fine-grain control over
execution of OS processes.</p><p>The following features are supported:</p><ul><li>Start/stop OS commands and get their OS process IDs, and termination reason
(exit code, signal number, core dump status).</li><li>Support OS commands with unicode characters.</li><li>Manage/monitor externally started OS processes.</li><li>Execute OS processes synchronously and asynchronously.</li><li>Set OS command's working directory, environment, process group, effective user, process priority.</li><li>Provide custom termination command for killing a process or relying on
default SIGTERM/SIGKILL behavior.</li><li>Specify custom timeout for SIGKILL after the termination command or SIGTERM
was executed and the running OS child process is still alive.</li><li>Link Erlang processes to OS processes (via intermediate Erlang Pids that are linked
to an associated OS process), so that the termination of an OS process results
in termination of an Erlang Pid, and vice versa.</li><li>Monitor termination of OS processes using <code class="inline">erlang:monitor/2</code>.</li><li>Terminate all processes belonging to an OS process group.</li><li>Kill processes belonging to an OS process group at process exit.</li><li>Communicate with an OS process via its STDIN.</li><li>Redirect STDOUT and STDERR of an OS process to a file, erlang process,
or a custom function. When redirected to a file, the file can be open in
append/truncate mode, and given at creation an access mask.</li><li>Run interactive processes with psudo-terminal pty support.</li><li>Support all RFC4254 pty psudo-terminal options defined in
<a href="https://datatracker.ietf.org/doc/html/rfc4254#section-8">section-8</a> of the spec.</li><li>Execute OS processes under different user credentials (using Linux capabilities).</li><li>Perform proper cleanup of OS child processes at port program termination time.</li></ul><p>This application provides significantly better control
over OS processes than built-in <code class="inline">erlang:open_port/2</code> command with a
<code class="inline">{spawn, Command}</code> option, and performs proper OS child process cleanup
when the emulator exits. </p><p>The <code class="inline">erlexec</code> application has been in production use by Erlang and Elixir systems,
and is considered stable.</p><h2 id="donations" class="section-heading">
  <a href="#donations" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">donations</p>
  </a>
  Donations
</h2>
<p>If you find this project useful, please donate to:</p><ul><li>Bitcoin: <code class="inline">12pt8TcoMWMkF6iY66VJQk95ntdN4pFihg</code></li><li>Ethereum: <code class="inline">0x268295486F258037CF53E504fcC1E67eba014218</code></li></ul><h2 id="supported-platforms" class="section-heading">
  <a href="#supported-platforms" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">supported-platforms</p>
  </a>
  Supported Platforms
</h2>
<p>Linux, Solaris, FreeBSD, OpenBSD, MacOS X</p><h2 id="documentation" class="section-heading">
  <a href="#documentation" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">documentation</p>
  </a>
  DOCUMENTATION
</h2>
<p>See <a href="https://hexdocs.pm/erlexec/readme.html">https://hexdocs.pm/erlexec/readme.html</a></p><h2 id="usage" class="section-heading">
  <a href="#usage" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">usage</p>
  </a>
  USAGE
</h2>
<h3 id="erlang-import-as-a-dependency" class="section-heading">
  <a href="#erlang-import-as-a-dependency" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">erlang-import-as-a-dependency</p>
  </a>
  Erlang: import as a dependency
</h3>
<ul><li><p>Add dependency in <code class="inline">rebar.config</code>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="5995639729-1">{</span><span class="ss">deps</span><span class="p">,</span><span class="w">
 </span><span class="p" data-group-id="5995639729-2">[</span><span class="c1">% ...</span><span class="w">
  </span><span class="p" data-group-id="5995639729-3">{</span><span class="ss">erlexec</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&gt; 2.0&quot;</span><span class="p" data-group-id="5995639729-3">}</span><span class="w">
  </span><span class="p" data-group-id="5995639729-2">]</span><span class="p" data-group-id="5995639729-1">}</span><span class="p">.</span></code></pre></li><li><p>Include in your <code class="inline">*.app.src</code>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="9461078896-1">{</span><span class="ss">applications</span><span class="p">,</span><span class="w">
   </span><span class="p" data-group-id="9461078896-2">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w">
    </span><span class="ss">stdlib</span><span class="p">,</span><span class="w">
    </span><span class="c1">% ...</span><span class="w">
    </span><span class="ss">erlexec</span><span class="w">
   </span><span class="p" data-group-id="9461078896-2">]</span><span class="p" data-group-id="9461078896-1">}</span></code></pre></li></ul><h3 id="elixir-import-as-a-dependency" class="section-heading">
  <a href="#elixir-import-as-a-dependency" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">elixir-import-as-a-dependency</p>
  </a>
  Elixir: import as a dependency
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">defp</span><span class="w"> </span><span class="nf">deps</span><span class="w"> </span><span class="k" data-group-id="2092786067-1">do</span><span class="w">
  </span><span class="p" data-group-id="2092786067-2">[</span><span class="w">
    </span><span class="c1"># ...</span><span class="w">
    </span><span class="p" data-group-id="2092786067-3">{</span><span class="ss">:erlexec</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&gt; 2.0&quot;</span><span class="p" data-group-id="2092786067-3">}</span><span class="w">
  </span><span class="p" data-group-id="2092786067-2">]</span><span class="w">
</span><span class="k" data-group-id="2092786067-1">end</span></code></pre><h2 id="building-from-source" class="section-heading">
  <a href="#building-from-source" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">building-from-source</p>
  </a>
  BUILDING FROM SOURCE
</h2>
<p>Make sure you have <a href="http://github.com/basho/rebar">rebar</a> or
<a href="http://github.com/basho/rebar3">rebar3</a> installed locally and the rebar script
is in the path.</p><p>If you are deploying the application on Linux and would like to
take advantage of exec-port running tasks using effective user IDs
different from the real user ID that started exec-port, then
either make sure that libcap-dev[el] library is installed or make
sure that the user running the port program has <code class="inline">sudo</code> rights.</p><p>OS-specific libcap-dev installation instructions:</p><ul><li>Fedora, CentOS: &quot;yum install libcap-devel&quot;</li><li>Ubuntu:         &quot;apt-get install libcap-dev&quot;</li></ul><pre><code class="makeup bash" translate="no"><span class="gp unselectable">$ </span><span class="">git clone git@github.com:saleyn/erlexec.git
</span><span class="gp unselectable">$ </span><span class="">make
</span><span class="">
</span><span class=""># NOTE: for disabling optimized build of exec-port, do the following instead:
</span><span class="gp unselectable">$ </span><span class="">OPTIMIZE=0 make
</span></code></pre><p>By default port program's implementation uses <code class="inline">poll(2)</code> call for event
demultiplexing. If you prefer to use <code class="inline">select(2)</code>, set the following environment
variable:</p><pre><code class="makeup bash" translate="no"><span class="gp unselectable">$ </span><span class="">USE_POLL=0 make
</span></code></pre><h2 id="license" class="section-heading">
  <a href="#license" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">license</p>
  </a>
  LICENSE
</h2>
<p>The program is distributed under BSD license.</p><p>Copyright (c) 2003 Serge Aleynikov</p><h2 id="architecture" class="section-heading">
  <a href="#architecture" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">architecture</p>
  </a>
  Architecture
</h2>
<pre><code class="makeup elixir" translate="no"><span class="w">  </span><span class="o">*</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">*</span><span class="w">
  </span><span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w">    </span><span class="o">|</span><span class="w">
  </span><span class="o">|</span><span class="w">   </span><span class="o">|</span><span class="nc">Pid1</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="nc">Pid2</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="nc">PidN</span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nc">Erlang</span><span class="w"> </span><span class="n">light</span><span class="o">-</span><span class="n">weight</span><span class="w"> </span><span class="nc">Pids</span><span class="w"> </span><span class="n">associated</span><span class="w">
  </span><span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="n">one</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">one</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">managed</span><span class="w"> </span><span class="nc">OsPids</span><span class="w">
  </span><span class="o">|</span><span class="w">         </span><span class="err">\</span><span class="w">   </span><span class="o">|</span><span class="w">   </span><span class="o">/</span><span class="w">         </span><span class="o">|</span><span class="w">
  </span><span class="o">|</span><span class="w">          </span><span class="err">\</span><span class="w">  </span><span class="o">|</span><span class="w">  </span><span class="o">/</span><span class="w">          </span><span class="o">|</span><span class="w">
  </span><span class="o">|</span><span class="w">           </span><span class="err">\</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p" data-group-id="7830775694-1">(</span><span class="n">links</span><span class="p" data-group-id="7830775694-1">)</span><span class="w">   </span><span class="o">|</span><span class="w">
  </span><span class="o">|</span><span class="w">         </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w">          </span><span class="o">|</span><span class="w">
  </span><span class="o">|</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="o">|</span><span class="w">          </span><span class="o">|</span><span class="w">   </span><span class="nc">Exec</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">Erlang</span><span class="w"> </span><span class="nc">VM</span><span class="w">
  </span><span class="o">|</span><span class="w">         </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w">          </span><span class="o">|</span><span class="w">
  </span><span class="o">|</span><span class="w"> </span><span class="nc">Erlang</span><span class="w"> </span><span class="nc">VM</span><span class="w">   </span><span class="o">|</span><span class="w">             </span><span class="o">|</span><span class="w">
  </span><span class="o">*</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">*</span><span class="w">
                </span><span class="o">|</span><span class="w">
          </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
          </span><span class="o">|</span><span class="w"> </span><span class="n">exec</span><span class="o">-</span><span class="n">port</span><span class="w"> </span><span class="o">|</span><span class="w">           </span><span class="nc">Port</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="p" data-group-id="7830775694-2">(</span><span class="n">separate</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="n">process</span><span class="p" data-group-id="7830775694-2">)</span><span class="w">
          </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">-</span><span class="o">+</span><span class="w">
           </span><span class="o">/</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="err">\</span><span class="w">
 </span><span class="p" data-group-id="7830775694-3">(</span><span class="n">optional</span><span class="w"> </span><span class="n">stdin</span><span class="o">/</span><span class="n">stdout</span><span class="o">/</span><span class="n">stderr</span><span class="w"> </span><span class="n">pipes</span><span class="p" data-group-id="7830775694-3">)</span><span class="w">
         </span><span class="o">/</span><span class="w">      </span><span class="o">|</span><span class="w">      </span><span class="err">\</span><span class="w">
    </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w">
    </span><span class="o">|</span><span class="nc">OsPid1</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="nc">OsPid2</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="nc">OsPidN</span><span class="o">|</span><span class="w">    </span><span class="nc">Managed</span><span class="w"> </span><span class="nc">Child</span><span class="w"> </span><span class="nc">OS</span><span class="w"> </span><span class="n">processes</span><span class="w">
    </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span><span class="w"> </span><span class="o">+</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">+</span></code></pre><h2 id="configuration-options" class="section-heading">
  <a href="#configuration-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">configuration-options</p>
  </a>
  Configuration Options
</h2>
<p>See description of types in {@link exec:exec_options()}.</p><p>The <code class="inline">exec-port</code> program requires the <code class="inline">SHELL</code> variable to be set. If you are
running Erlang inside a docker container, you might need to ensure that <code class="inline">SHELL</code>
is properly set prior to starting the emulator.</p><h2 id="examples" class="section-heading">
  <a href="#examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<h3 id="starting-stopping-an-os-process" class="section-heading">
  <a href="#starting-stopping-an-os-process" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">starting-stopping-an-os-process</p>
  </a>
  Starting/stopping an OS process
</h3>
<pre><code class="makeup erlang" translate="no"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="3841972965-1">(</span><span class="p" data-group-id="3841972965-1">)</span><span class="p">.</span><span class="w">                                        </span><span class="c1">% Start the port program.</span><span class="w">
</span><span class="p" data-group-id="3841972965-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.32</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p" data-group-id="3841972965-2">}</span><span class="w">
</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="3841972965-3">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p" data-group-id="3841972965-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run_link</span><span class="p" data-group-id="3841972965-4">(</span><span class="s">&quot;sleep 1000&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3841972965-5">[</span><span class="p" data-group-id="3841972965-5">]</span><span class="p" data-group-id="3841972965-4">)</span><span class="p">.</span><span class="w">        </span><span class="c1">% Run a shell command to sleep for 1000s.</span><span class="w">
</span><span class="p" data-group-id="3841972965-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.34</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">23584</span><span class="p" data-group-id="3841972965-6">}</span><span class="w">
</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="3841972965-7">(</span><span class="n">I</span><span class="p" data-group-id="3841972965-7">)</span><span class="p">.</span><span class="w">                                        </span><span class="c1">% Kill the shell command.</span><span class="w">
</span><span class="ss">ok</span><span class="w">                                                      </span><span class="c1">% Note that this could also be accomplished</span><span class="w">
                                                        </span><span class="c1">% by doing exec:stop(pid(0,34,0)).</span></code></pre><p>In Elixir:</p><pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex(1)&gt; </span><span class="nc">:exec</span><span class="o">.</span><span class="n">start</span><span class="w">
</span><span class="p" data-group-id="7230024365-1">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7230024365-2">#</span><span class="nc" data-group-id="7230024365-2">PID</span><span class="p" data-group-id="7230024365-2">&lt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">112</span><span class="o">.</span><span class="mi">0</span><span class="p" data-group-id="7230024365-2">&gt;</span><span class="p" data-group-id="7230024365-1">}</span><span class="w">
</span><span class="gp unselectable">iex(2)&gt; </span><span class="nc">:exec</span><span class="o">.</span><span class="n">run</span><span class="p" data-group-id="7230024365-3">(</span><span class="s">&quot;echo ok&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7230024365-4">[</span><span class="ss">:sync</span><span class="p">,</span><span class="w"> </span><span class="ss">:stdout</span><span class="p" data-group-id="7230024365-4">]</span><span class="p" data-group-id="7230024365-3">)</span><span class="w">
</span><span class="p" data-group-id="7230024365-5">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7230024365-6">[</span><span class="ss">stdout</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7230024365-7">[</span><span class="s">&quot;ok</span><span class="se">\n</span><span class="s">&quot;</span><span class="p" data-group-id="7230024365-7">]</span><span class="p" data-group-id="7230024365-6">]</span><span class="p" data-group-id="7230024365-5">}</span></code></pre><h3 id="clearing-environment-or-unsetting-an-env-variable-of-the-child-process" class="section-heading">
  <a href="#clearing-environment-or-unsetting-an-env-variable-of-the-child-process" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">clearing-environment-or-unsetting-an-env-variable-of-the-child-process</p>
  </a>
  Clearing environment or unsetting an env variable of the child process
</h3>
<pre><code class="makeup erlang" translate="no"><span class="c1">%% Clear environment with {env, [clear]} option:</span><span class="w">
</span><span class="mi">10</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="3791001501-1">(</span><span class="n">Bin</span><span class="p" data-group-id="3791001501-1">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-3">[</span><span class="p" data-group-id="3791001501-4">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-5">[</span><span class="n">Bin</span><span class="p" data-group-id="3791001501-5">]</span><span class="p" data-group-id="3791001501-4">}</span><span class="p" data-group-id="3791001501-3">]</span><span class="p" data-group-id="3791001501-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="3791001501-6">(</span><span class="s">&quot;env&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-7">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-8">{</span><span class="ss">env</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-9">[</span><span class="ss">clear</span><span class="p" data-group-id="3791001501-9">]</span><span class="p" data-group-id="3791001501-8">}</span><span class="p" data-group-id="3791001501-7">]</span><span class="p" data-group-id="3791001501-6">)</span><span class="p">,</span><span class="w"> </span><span class="nf">p</span><span class="p" data-group-id="3791001501-10">(</span><span class="nc">re</span><span class="p">:</span><span class="nf">split</span><span class="p" data-group-id="3791001501-11">(</span><span class="n">Bin</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="3791001501-11">)</span><span class="p" data-group-id="3791001501-10">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="3791001501-12">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;PWD=/home/...&quot;</span><span class="p">&gt;&gt;</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;SHLVL=0&quot;</span><span class="p">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;_=/usr/bin/env&quot;</span><span class="p">&gt;&gt;</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="3791001501-12">]</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="c1">%% Clear env and add a &quot;TEST&quot; env variable:</span><span class="w">
</span><span class="mi">11</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="3791001501-13">(</span><span class="n">Bin</span><span class="p" data-group-id="3791001501-13">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-14">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-15">[</span><span class="p" data-group-id="3791001501-16">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-17">[</span><span class="n">Bin</span><span class="p" data-group-id="3791001501-17">]</span><span class="p" data-group-id="3791001501-16">}</span><span class="p" data-group-id="3791001501-15">]</span><span class="p" data-group-id="3791001501-14">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="3791001501-18">(</span><span class="s">&quot;env&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-19">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-20">{</span><span class="ss">env</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-21">[</span><span class="ss">clear</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-22">{</span><span class="s">&quot;TEST&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;xxx&quot;</span><span class="p" data-group-id="3791001501-22">}</span><span class="p" data-group-id="3791001501-21">]</span><span class="p" data-group-id="3791001501-20">}</span><span class="p" data-group-id="3791001501-19">]</span><span class="p" data-group-id="3791001501-18">)</span><span class="p">,</span><span class="w"> </span><span class="nf">p</span><span class="p" data-group-id="3791001501-23">(</span><span class="nc">re</span><span class="p">:</span><span class="nf">split</span><span class="p" data-group-id="3791001501-24">(</span><span class="n">Bin</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="3791001501-24">)</span><span class="p" data-group-id="3791001501-23">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="3791001501-25">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;PWD=/home/...&quot;</span><span class="p">&gt;&gt;</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;SHLVL=0&quot;</span><span class="p">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;_=/usr/bin/env&quot;</span><span class="p">&gt;&gt;</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;TEST=xxx&quot;</span><span class="p">&gt;&gt;</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="3791001501-25">]</span><span class="w">
</span><span class="c1">%% Unset an &quot;EMU&quot; env variable:</span><span class="w">
</span><span class="mi">11</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="3791001501-26">(</span><span class="n">Bin</span><span class="p" data-group-id="3791001501-26">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-27">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-28">[</span><span class="p" data-group-id="3791001501-29">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-30">[</span><span class="n">Bin</span><span class="p" data-group-id="3791001501-30">]</span><span class="p" data-group-id="3791001501-29">}</span><span class="p" data-group-id="3791001501-28">]</span><span class="p" data-group-id="3791001501-27">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="3791001501-31">(</span><span class="s">&quot;env&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-32">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-33">{</span><span class="ss">env</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3791001501-34">[</span><span class="p" data-group-id="3791001501-35">{</span><span class="s">&quot;EMU&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="3791001501-35">}</span><span class="p" data-group-id="3791001501-34">]</span><span class="p" data-group-id="3791001501-33">}</span><span class="p" data-group-id="3791001501-32">]</span><span class="p" data-group-id="3791001501-31">)</span><span class="p">,</span><span class="w"> </span><span class="nf">p</span><span class="p" data-group-id="3791001501-36">(</span><span class="nc">re</span><span class="p">:</span><span class="nf">split</span><span class="p" data-group-id="3791001501-37">(</span><span class="n">Bin</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="3791001501-37">)</span><span class="p" data-group-id="3791001501-36">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="3791001501-38">[</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="3791001501-38">]</span><span class="w">
</span><span class="ss">ok</span></code></pre><h3 id="running-exec-port-as-another-effective-user" class="section-heading">
  <a href="#running-exec-port-as-another-effective-user" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">running-exec-port-as-another-effective-user</p>
  </a>
  Running exec-port as another effective user
</h3>
<p>In order to be able to use this feature the current user must either have <code class="inline">sudo</code>
rights or the <code class="inline">exec-port</code> file must be owned by <code class="inline">root</code> and have the SUID bit set
(use: <code class="inline">chown root:root exec-port; chmod 4555 exec-port</code>):</p><pre><code class="makeup bash" translate="no"><span class="gp unselectable">$ </span><span class="">ll priv/x86_64-unknown-linux-gnu/exec-port
</span><span class="">-rwsr-xr-x 1 root root 777336 Dec  8 10:02 ./priv/x86_64-unknown-linux-gnu/exec-port
</span></code></pre><p>If the effective user doesn't have rights to access the <code class="inline">exec-port</code>
program in the real user's directory, then the <code class="inline">exec-port</code> can be copied to some
shared location, which will be specified at startup using
<code class="inline">{portexe, &quot;/path/to/exec-port&quot;}</code>.</p><pre><code class="makeup erlang" translate="no"><span class="sc">$ </span><span class="ss">cp</span><span class="w"> </span><span class="sc">$(</span><span class="ss">find</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="ss">name</span><span class="w"> </span><span class="ss">exec</span><span class="o">-</span><span class="ss">port</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="ss">tmp</span><span class="w">
</span><span class="sc">$ </span><span class="ss">chmod</span><span class="w"> </span><span class="mi">755</span><span class="w"> </span><span class="o">/</span><span class="ss">tmp</span><span class="o">/</span><span class="ss">exec</span><span class="o">-</span><span class="ss">port</span><span class="w">

</span><span class="sc">$ </span><span class="ss">whoami</span><span class="w">
</span><span class="ss">serge</span><span class="w">

</span><span class="sc">$ </span><span class="ss">erl</span><span class="w">
</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="1563965513-1">(</span><span class="p" data-group-id="1563965513-2">[</span><span class="p" data-group-id="1563965513-3">{</span><span class="ss">user</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;wheel&quot;</span><span class="p" data-group-id="1563965513-3">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1563965513-4">{</span><span class="ss">portexe</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/tmp/exec-port&quot;</span><span class="p" data-group-id="1563965513-4">}</span><span class="p" data-group-id="1563965513-2">]</span><span class="p" data-group-id="1563965513-1">)</span><span class="p">.</span><span class="w">  </span><span class="c1">% Start the port program as effective user &quot;wheel&quot;.</span><span class="w">
</span><span class="p" data-group-id="1563965513-5">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.32</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p" data-group-id="1563965513-5">}</span><span class="w">

</span><span class="sc">$ </span><span class="ss">ps</span><span class="w"> </span><span class="ss">haxo</span><span class="w"> </span><span class="ss">user</span><span class="p">,</span><span class="ss">comm</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">grep</span><span class="w"> </span><span class="ss">exec</span><span class="o">-</span><span class="ss">port</span><span class="w">
</span><span class="ss">wheel</span><span class="w">      </span><span class="ss">exec</span><span class="o">-</span><span class="ss">port</span></code></pre><h3 id="allowing-exec-port-to-run-commands-as-other-effective-users" class="section-heading">
  <a href="#allowing-exec-port-to-run-commands-as-other-effective-users" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">allowing-exec-port-to-run-commands-as-other-effective-users</p>
  </a>
  Allowing exec-port to run commands as other effective users
</h3>
<p>In order to be able to use this feature the current user must either have <code class="inline">sudo</code>
rights or the <code class="inline">exec-port</code> file must have the SUID bit set, and the <code class="inline">exec-port</code> file
must have the capabilities set as described in the &quot;Build&quot; section above.</p><p>The port program will initially be started as <code class="inline">root</code>, and then it will 
switch the effective user to <code class="inline">{user, User}</code> and set process capabilities to
<code class="inline">cap_setuid,cap_kill,cap_sys_nice</code>.  After that it'll allow to run child programs
under effective users listed in the <code class="inline">{limit_users, Users}</code> option.</p><pre><code class="makeup erlang" translate="no"><span class="sc">$ </span><span class="ss">whoami</span><span class="w">
</span><span class="ss">serge</span><span class="w">

</span><span class="sc">$ </span><span class="ss">erl</span><span class="w">
</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5846152174-1">[</span><span class="ss">root</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5846152174-2">{</span><span class="ss">user</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;wheel&quot;</span><span class="p" data-group-id="5846152174-2">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5846152174-3">{</span><span class="ss">limit_users</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5846152174-4">[</span><span class="s">&quot;alex&quot;</span><span class="p">,</span><span class="s">&quot;guest&quot;</span><span class="p" data-group-id="5846152174-4">]</span><span class="p" data-group-id="5846152174-3">}</span><span class="p" data-group-id="5846152174-1">]</span><span class="p">,</span><span class="w">
</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="5846152174-5">(</span><span class="n">Opts</span><span class="p" data-group-id="5846152174-5">)</span><span class="p">.</span><span class="w">                                    </span><span class="c1">% Start the port program as effective user &quot;wheel&quot;</span><span class="w">
                                                        </span><span class="c1">% and allow it to execute commands as &quot;alex&quot; or &quot;guest&quot;.</span><span class="w">
</span><span class="p" data-group-id="5846152174-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.32</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p" data-group-id="5846152174-6">}</span><span class="w">
</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="5846152174-7">(</span><span class="s">&quot;whoami&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5846152174-8">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5846152174-9">{</span><span class="ss">user</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;alex&quot;</span><span class="p" data-group-id="5846152174-9">}</span><span class="p" data-group-id="5846152174-8">]</span><span class="p" data-group-id="5846152174-7">)</span><span class="p">.</span><span class="w">  </span><span class="c1">% Command is executed under effective user &quot;alex&quot;</span><span class="w">
</span><span class="p" data-group-id="5846152174-10">{</span><span class="ss">ok</span><span class="p">,</span><span class="p" data-group-id="5846152174-11">[</span><span class="p" data-group-id="5846152174-12">{</span><span class="ss">stdout</span><span class="p">,</span><span class="p" data-group-id="5846152174-13">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;alex\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="5846152174-13">]</span><span class="p" data-group-id="5846152174-12">}</span><span class="p" data-group-id="5846152174-11">]</span><span class="p" data-group-id="5846152174-10">}</span><span class="w">

</span><span class="sc">$ </span><span class="ss">ps</span><span class="w"> </span><span class="ss">haxo</span><span class="w"> </span><span class="ss">user</span><span class="p">,</span><span class="ss">comm</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">grep</span><span class="w"> </span><span class="ss">exec</span><span class="o">-</span><span class="ss">port</span><span class="w">
</span><span class="ss">wheel</span><span class="w">      </span><span class="ss">exec</span><span class="o">-</span><span class="ss">port</span></code></pre><h3 id="running-the-port-program-as-root" class="section-heading">
  <a href="#running-the-port-program-as-root" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">running-the-port-program-as-root</p>
  </a>
  Running the port program as root
</h3>
<p>While running the port program as root is highly discouraged, since it opens a security
hole that gives users an ability to damage the system, for those who might need such an
option, here is how to get it done (PROCEED AT YOUR OWN RISK!!!).</p><p>Note: in this case <code class="inline">exec</code> would use <code class="inline">sudo exec-port</code> to run it as <code class="inline">root</code> or the <code class="inline">exec-port</code>
must have the SUID bit set (4555) and be owned by <code class="inline">root</code>.  The other (DANGEROUS and
firmly DISCOURAGED!!!) alternative is to run <code class="inline">erl</code> as <code class="inline">root</code>:</p><pre><code class="makeup erlang" translate="no"><span class="sc">$ </span><span class="ss">whoami</span><span class="w">
</span><span class="ss">serge</span><span class="w">

</span><span class="p">#</span><span class="w"> </span><span class="n">Make</span><span class="w"> </span><span class="ss">sure</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">exec</span><span class="o">-</span><span class="ss">port</span><span class="w"> </span><span class="ss">can</span><span class="w"> </span><span class="ss">run</span><span class="w"> </span><span class="ss">as</span><span class="w"> </span><span class="nc">root</span><span class="p">:</span><span class="w">
</span><span class="sc">$ </span><span class="ss">sudo</span><span class="w"> </span><span class="p">_</span><span class="ss">build</span><span class="o">/</span><span class="ss">default</span><span class="o">/</span><span class="ss">lib</span><span class="o">/</span><span class="ss">erlexec</span><span class="o">/</span><span class="ss">priv</span><span class="o">/</span><span class="o">*</span><span class="o">/</span><span class="ss">exec</span><span class="o">-</span><span class="ss">port</span><span class="w"> </span><span class="o">--</span><span class="ss">whoami</span><span class="w">
</span><span class="ss">root</span><span class="w">

</span><span class="sc">$ </span><span class="ss">erl</span><span class="w">
</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="7109982698-1">(</span><span class="p" data-group-id="7109982698-2">[</span><span class="ss">root</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7109982698-3">{</span><span class="ss">user</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;root&quot;</span><span class="p" data-group-id="7109982698-3">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7109982698-4">{</span><span class="ss">limit_users</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7109982698-5">[</span><span class="s">&quot;root&quot;</span><span class="p" data-group-id="7109982698-5">]</span><span class="p" data-group-id="7109982698-4">}</span><span class="p" data-group-id="7109982698-2">]</span><span class="p" data-group-id="7109982698-1">)</span><span class="p">.</span><span class="w">
</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="7109982698-6">(</span><span class="s">&quot;whoami&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7109982698-7">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p" data-group-id="7109982698-7">]</span><span class="p" data-group-id="7109982698-6">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="7109982698-8">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7109982698-9">[</span><span class="p" data-group-id="7109982698-10">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7109982698-11">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;root\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="7109982698-11">]</span><span class="p" data-group-id="7109982698-10">}</span><span class="p" data-group-id="7109982698-9">]</span><span class="p" data-group-id="7109982698-8">}</span><span class="w">

</span><span class="sc">$ </span><span class="ss">ps</span><span class="w"> </span><span class="ss">haxo</span><span class="w"> </span><span class="ss">user</span><span class="p">,</span><span class="ss">comm</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">grep</span><span class="w"> </span><span class="ss">exec</span><span class="o">-</span><span class="ss">port</span><span class="w">
</span><span class="ss">root</span><span class="w">       </span><span class="ss">exec</span><span class="o">-</span><span class="ss">port</span></code></pre><h3 id="killing-an-os-process" class="section-heading">
  <a href="#killing-an-os-process" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">killing-an-os-process</p>
  </a>
  Killing an OS process
</h3>
<p>Note that killing a process can be accomplished by running kill(3) command
in an external shell, or by executing exec:kill/2.</p><pre><code class="makeup erlang" translate="no"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="7306769763-1">(</span><span class="n">I</span><span class="p" data-group-id="7306769763-1">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7306769763-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p" data-group-id="7306769763-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run_link</span><span class="p" data-group-id="7306769763-3">(</span><span class="s">&quot;sleep 1000&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7306769763-4">[</span><span class="p" data-group-id="7306769763-4">]</span><span class="p" data-group-id="7306769763-3">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="7306769763-5">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.37</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">2350</span><span class="p" data-group-id="7306769763-5">}</span><span class="w">
</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">kill</span><span class="p" data-group-id="7306769763-6">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p" data-group-id="7306769763-6">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="o">*</span><span class="o">*</span><span class="w"> </span><span class="ss">exception</span><span class="w"> </span><span class="nc">error</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7306769763-7">{</span><span class="ss">exit_status</span><span class="p">,</span><span class="mi">15</span><span class="p" data-group-id="7306769763-7">}</span><span class="w">                    </span><span class="c1">% Our shell died because we linked to the</span><span class="w">
                                                        </span><span class="c1">% killed shell process via exec:run_link/2.</span><span class="w">

</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">status</span><span class="p" data-group-id="7306769763-8">(</span><span class="mi">15</span><span class="p" data-group-id="7306769763-8">)</span><span class="p">.</span><span class="w">                                     </span><span class="c1">% Examine the exit status.</span><span class="w">
</span><span class="p" data-group-id="7306769763-9">{</span><span class="ss">signal</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="ss">false</span><span class="p" data-group-id="7306769763-9">}</span><span class="w">                                       </span><span class="c1">% The program got SIGTERM signal and produced</span><span class="w">
                                                        </span><span class="c1">% no core file.</span></code></pre><h3 id="using-a-custom-success-return-code" class="section-heading">
  <a href="#using-a-custom-success-return-code" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">using-a-custom-success-return-code</p>
  </a>
  Using a custom success return code
</h3>
<pre><code class="makeup erlang" translate="no"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">start_link</span><span class="p" data-group-id="6978523454-1">(</span><span class="p" data-group-id="6978523454-2">[</span><span class="p" data-group-id="6978523454-2">]</span><span class="p" data-group-id="6978523454-1">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="6978523454-3">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.35</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p" data-group-id="6978523454-3">}</span><span class="w">
</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run_link</span><span class="p" data-group-id="6978523454-4">(</span><span class="s">&quot;sleep 1&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6978523454-5">[</span><span class="p" data-group-id="6978523454-6">{</span><span class="ss">success_exit_code</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="6978523454-6">}</span><span class="p">,</span><span class="w"> </span><span class="ss">sync</span><span class="p" data-group-id="6978523454-5">]</span><span class="p" data-group-id="6978523454-4">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="6978523454-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="p" data-group-id="6978523454-8">[</span><span class="p" data-group-id="6978523454-8">]</span><span class="p" data-group-id="6978523454-7">}</span><span class="w">
</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="6978523454-9">(</span><span class="s">&quot;sleep 1&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6978523454-10">[</span><span class="p" data-group-id="6978523454-11">{</span><span class="ss">success_exit_code</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="6978523454-11">}</span><span class="p">,</span><span class="w"> </span><span class="ss">sync</span><span class="p" data-group-id="6978523454-10">]</span><span class="p" data-group-id="6978523454-9">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="6978523454-12">{</span><span class="ss">error</span><span class="p">,</span><span class="p" data-group-id="6978523454-13">[</span><span class="p" data-group-id="6978523454-14">{</span><span class="ss">exit_status</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="6978523454-14">}</span><span class="p" data-group-id="6978523454-13">]</span><span class="p" data-group-id="6978523454-12">}</span><span class="w">                               </span><span class="c1">% Note that the command returns exit code 1</span></code></pre><h3 id="redirecting-os-process-stdout-to-a-file" class="section-heading">
  <a href="#redirecting-os-process-stdout-to-a-file" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">redirecting-os-process-stdout-to-a-file</p>
  </a>
  Redirecting OS process stdout to a file
</h3>
<pre><code class="makeup erlang" translate="no"><span class="mi">7</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="9273293726-1">(</span><span class="n">I</span><span class="p" data-group-id="9273293726-1">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9273293726-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p" data-group-id="9273293726-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run_link</span><span class="p" data-group-id="9273293726-3">(</span><span class="s">&quot;for i in 1 2 3; do echo \&quot;Test$i\&quot;; done&quot;</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="9273293726-4">[</span><span class="p" data-group-id="9273293726-5">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/tmp/output&quot;</span><span class="p" data-group-id="9273293726-5">}</span><span class="p" data-group-id="9273293726-4">]</span><span class="p" data-group-id="9273293726-3">)</span><span class="p">.</span><span class="w">
</span><span class="mi">8</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="9273293726-6">(</span><span class="s">&quot;</span><span class="si">~s</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9273293726-7">[</span><span class="nf">binary_to_list</span><span class="p" data-group-id="9273293726-8">(</span><span class="nf">element</span><span class="p" data-group-id="9273293726-9">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nc">file</span><span class="p">:</span><span class="nf">read_file</span><span class="p" data-group-id="9273293726-10">(</span><span class="s">&quot;/tmp/output&quot;</span><span class="p" data-group-id="9273293726-10">)</span><span class="p" data-group-id="9273293726-9">)</span><span class="p" data-group-id="9273293726-8">)</span><span class="p" data-group-id="9273293726-7">]</span><span class="p" data-group-id="9273293726-6">)</span><span class="p">,</span><span class="w">
   </span><span class="nc">file</span><span class="p">:</span><span class="nf">delete</span><span class="p" data-group-id="9273293726-11">(</span><span class="s">&quot;/tmp/output&quot;</span><span class="p" data-group-id="9273293726-11">)</span><span class="p">.</span><span class="w">
</span><span class="n">Test1</span><span class="w">
</span><span class="n">Test2</span><span class="w">
</span><span class="n">Test3</span><span class="w">
</span><span class="ss">ok</span></code></pre><h3 id="redirecting-os-process-stdout-to-screen-an-erlang-process-or-a-custom-function" class="section-heading">
  <a href="#redirecting-os-process-stdout-to-screen-an-erlang-process-or-a-custom-function" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">redirecting-os-process-stdout-to-screen-an-erlang-process-or-a-custom-function</p>
  </a>
  Redirecting OS process stdout to screen, an Erlang process or a custom function
</h3>
<pre><code class="makeup erlang" translate="no"><span class="mi">9</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="8333289007-1">(</span><span class="s">&quot;echo Test&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8333289007-2">[</span><span class="p" data-group-id="8333289007-3">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="ss">print</span><span class="p" data-group-id="8333289007-3">}</span><span class="p" data-group-id="8333289007-2">]</span><span class="p" data-group-id="8333289007-1">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8333289007-4">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.119</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">29651</span><span class="p" data-group-id="8333289007-4">}</span><span class="w">
</span><span class="n">Got</span><span class="w"> </span><span class="ss">stdout</span><span class="w"> </span><span class="ss">from</span><span class="w"> </span><span class="mi">29651</span><span class="p">:</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;Test\n&quot;</span><span class="p">&gt;&gt;</span><span class="w">

</span><span class="mi">10</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="8333289007-5">(</span><span class="s">&quot;for i in 1 2 3; do sleep 1; echo \&quot;Iter$i\&quot;; done&quot;</span><span class="p">,</span><span class="w">
            </span><span class="p" data-group-id="8333289007-6">[</span><span class="p" data-group-id="8333289007-7">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="8333289007-8">(</span><span class="n">S</span><span class="p">,</span><span class="n">OsPid</span><span class="p">,</span><span class="n">D</span><span class="p" data-group-id="8333289007-8">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="8333289007-9">(</span><span class="s">&quot;Got </span><span class="si">~w</span><span class="s"> from </span><span class="si">~w</span><span class="s">: </span><span class="si">~p</span><span class="s">\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8333289007-10">[</span><span class="n">S</span><span class="p">,</span><span class="n">OsPid</span><span class="p">,</span><span class="n">D</span><span class="p" data-group-id="8333289007-10">]</span><span class="p" data-group-id="8333289007-9">)</span><span class="w"> </span><span class="k">end</span><span class="p" data-group-id="8333289007-7">}</span><span class="p" data-group-id="8333289007-6">]</span><span class="p" data-group-id="8333289007-5">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8333289007-11">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.121</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">29652</span><span class="p" data-group-id="8333289007-11">}</span><span class="w">
</span><span class="n">Got</span><span class="w"> </span><span class="ss">stdout</span><span class="w"> </span><span class="ss">from</span><span class="w"> </span><span class="mi">29652</span><span class="p">:</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;Iter1\n&quot;</span><span class="p">&gt;&gt;</span><span class="w">
</span><span class="n">Got</span><span class="w"> </span><span class="ss">stdout</span><span class="w"> </span><span class="ss">from</span><span class="w"> </span><span class="mi">29652</span><span class="p">:</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;Iter2\n&quot;</span><span class="p">&gt;&gt;</span><span class="w">
</span><span class="n">Got</span><span class="w"> </span><span class="ss">stdout</span><span class="w"> </span><span class="ss">from</span><span class="w"> </span><span class="mi">29652</span><span class="p">:</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;Iter3\n&quot;</span><span class="p">&gt;&gt;</span><span class="w">

</span><span class="c1">% Note that stdout/stderr options are equivanet to {stdout, self()}, {stderr, self()} </span><span class="w">
</span><span class="mi">11</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="8333289007-12">(</span><span class="s">&quot;echo Hello World!; echo ERR!! 1&gt;&amp;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8333289007-13">[</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="ss">stderr</span><span class="p" data-group-id="8333289007-13">]</span><span class="p" data-group-id="8333289007-12">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8333289007-14">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.244</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">18382</span><span class="p" data-group-id="8333289007-14">}</span><span class="w">
</span><span class="mi">12</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">flush</span><span class="p" data-group-id="8333289007-15">(</span><span class="p" data-group-id="8333289007-15">)</span><span class="p">.</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="8333289007-16">{</span><span class="ss">stdout</span><span class="p">,</span><span class="mi">18382</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;Hello World!\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8333289007-16">}</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="8333289007-17">{</span><span class="ss">stderr</span><span class="p">,</span><span class="mi">18382</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;ERR!!\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8333289007-17">}</span><span class="w">
</span><span class="ss">ok</span></code></pre><h3 id="appending-os-process-stdout-to-a-file" class="section-heading">
  <a href="#appending-os-process-stdout-to-a-file" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">appending-os-process-stdout-to-a-file</p>
  </a>
  Appending OS process stdout to a file
</h3>
<pre><code class="makeup erlang" translate="no"><span class="mi">13</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="0533796466-1">(</span><span class="s">&quot;for i in 1 2 3; do echo TEST$i; done&quot;</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="0533796466-2">[</span><span class="p" data-group-id="0533796466-3">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/tmp/out&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0533796466-4">[</span><span class="ss">append</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0533796466-5">{</span><span class="ss">mode</span><span class="p">,</span><span class="w"> </span><span class="mi">8#600</span><span class="p" data-group-id="0533796466-5">}</span><span class="p" data-group-id="0533796466-4">]</span><span class="p" data-group-id="0533796466-3">}</span><span class="p">,</span><span class="w"> </span><span class="ss">sync</span><span class="p" data-group-id="0533796466-2">]</span><span class="p" data-group-id="0533796466-1">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">file</span><span class="p">:</span><span class="nf">read_file</span><span class="p" data-group-id="0533796466-6">(</span><span class="s">&quot;/tmp/out&quot;</span><span class="p" data-group-id="0533796466-6">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="0533796466-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;TEST1\nTEST2\nTEST3\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="0533796466-7">}</span><span class="w">
</span><span class="mi">14</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="0533796466-8">(</span><span class="s">&quot;echo Test4; done&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0533796466-9">[</span><span class="p" data-group-id="0533796466-10">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/tmp/out&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0533796466-11">[</span><span class="ss">append</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0533796466-12">{</span><span class="ss">mode</span><span class="p">,</span><span class="w"> </span><span class="mi">8#600</span><span class="p" data-group-id="0533796466-12">}</span><span class="p" data-group-id="0533796466-11">]</span><span class="p" data-group-id="0533796466-10">}</span><span class="p">,</span><span class="w"> </span><span class="ss">sync</span><span class="p" data-group-id="0533796466-9">]</span><span class="p" data-group-id="0533796466-8">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">file</span><span class="p">:</span><span class="nf">read_file</span><span class="p" data-group-id="0533796466-13">(</span><span class="s">&quot;/tmp/out&quot;</span><span class="p" data-group-id="0533796466-13">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="0533796466-14">{</span><span class="ss">ok</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;TEST1\nTEST2\nTEST3\nTest4\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="0533796466-14">}</span><span class="w">
</span><span class="mi">15</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">file</span><span class="p">:</span><span class="nf">delete</span><span class="p" data-group-id="0533796466-15">(</span><span class="s">&quot;/tmp/out&quot;</span><span class="p" data-group-id="0533796466-15">)</span><span class="p">.</span></code></pre><h3 id="setting-up-a-monitor-for-the-os-process" class="section-heading">
  <a href="#setting-up-a-monitor-for-the-os-process" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">setting-up-a-monitor-for-the-os-process</p>
  </a>
  Setting up a monitor for the OS process
</h3>
<pre><code class="makeup erlang" translate="no"><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="6030085781-1">(</span><span class="n">I</span><span class="p" data-group-id="6030085781-1">)</span><span class="p">,</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="6030085781-2">(</span><span class="n">P</span><span class="p" data-group-id="6030085781-2">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6030085781-3">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p" data-group-id="6030085781-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="6030085781-4">(</span><span class="s">&quot;echo ok&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6030085781-5">[</span><span class="p" data-group-id="6030085781-6">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="nf">self</span><span class="p" data-group-id="6030085781-7">(</span><span class="p" data-group-id="6030085781-7">)</span><span class="p" data-group-id="6030085781-6">}</span><span class="p">,</span><span class="w"> </span><span class="nb">monitor</span><span class="p" data-group-id="6030085781-5">]</span><span class="p" data-group-id="6030085781-4">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="6030085781-8">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.263</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">18950</span><span class="p" data-group-id="6030085781-8">}</span><span class="w">
</span><span class="mi">16</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">flush</span><span class="p" data-group-id="6030085781-9">(</span><span class="p" data-group-id="6030085781-9">)</span><span class="p">.</span><span class="w">                                                                  
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="6030085781-10">{</span><span class="ss">stdout</span><span class="p">,</span><span class="mi">18950</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;ok\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6030085781-10">}</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="6030085781-11">{</span><span class="ss">&#39;DOWN&#39;</span><span class="p">,</span><span class="mi">18950</span><span class="p">,</span><span class="ss">process</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.263</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="ss">normal</span><span class="p" data-group-id="6030085781-11">}</span><span class="w">
</span><span class="ss">ok</span></code></pre><h3 id="managing-an-externally-started-os-process" class="section-heading">
  <a href="#managing-an-externally-started-os-process" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">managing-an-externally-started-os-process</p>
  </a>
  Managing an externally started OS process
</h3>
<p>This command allows to instruct erlexec to begin monitoring given OS process
and notify Erlang when the process exits. It is also able to send signals to
the process and kill it.</p><pre><code class="makeup erlang" translate="no"><span class="c1">% Start an externally managed OS process and retrieve its OS PID:</span><span class="w">
</span><span class="mi">17</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">spawn</span><span class="p" data-group-id="9632187426-1">(</span><span class="nf">fun</span><span class="p" data-group-id="9632187426-2">(</span><span class="p" data-group-id="9632187426-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">os</span><span class="p">:</span><span class="nf">cmd</span><span class="p" data-group-id="9632187426-3">(</span><span class="s">&quot;echo $$ &gt; /tmp/pid; sleep 15&quot;</span><span class="p" data-group-id="9632187426-3">)</span><span class="w"> </span><span class="k">end</span><span class="p" data-group-id="9632187426-1">)</span><span class="p">.</span><span class="w">
</span><span class="o">&lt;</span><span class="mf">0.330</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="w">  
</span><span class="mi">18</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="9632187426-4">(</span><span class="n">P</span><span class="p" data-group-id="9632187426-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list_to_integer</span><span class="p" data-group-id="9632187426-5">(</span><span class="nc">lists</span><span class="p">:</span><span class="nf">reverse</span><span class="p" data-group-id="9632187426-6">(</span><span class="nf">tl</span><span class="p" data-group-id="9632187426-7">(</span><span class="nc">lists</span><span class="p">:</span><span class="nf">reverse</span><span class="p" data-group-id="9632187426-8">(</span><span class="nf">binary_to_list</span><span class="p" data-group-id="9632187426-9">(</span><span class="nf">element</span><span class="p" data-group-id="9632187426-10">(</span><span class="mi">2</span><span class="p">,</span><span class="w">
</span><span class="nc">file</span><span class="p">:</span><span class="nf">read_file</span><span class="p" data-group-id="9632187426-11">(</span><span class="s">&quot;/tmp/pid&quot;</span><span class="p" data-group-id="9632187426-11">)</span><span class="p" data-group-id="9632187426-10">)</span><span class="p" data-group-id="9632187426-9">)</span><span class="p" data-group-id="9632187426-8">)</span><span class="p" data-group-id="9632187426-7">)</span><span class="p" data-group-id="9632187426-6">)</span><span class="p" data-group-id="9632187426-5">)</span><span class="p">.</span><span class="w">
</span><span class="mi">19355</span><span class="w">

</span><span class="c1">% Manage the process and get notified by a monitor when it exits:</span><span class="w">
</span><span class="mi">19</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">manage</span><span class="p" data-group-id="9632187426-12">(</span><span class="n">P</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9632187426-13">[</span><span class="nb">monitor</span><span class="p" data-group-id="9632187426-13">]</span><span class="p" data-group-id="9632187426-12">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="9632187426-14">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.334</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">19355</span><span class="p" data-group-id="9632187426-14">}</span><span class="w">

</span><span class="c1">% Wait for monitor notification</span><span class="w">
</span><span class="mi">20</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="9632187426-15">(</span><span class="n">M</span><span class="p" data-group-id="9632187426-15">)</span><span class="p">,</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="k">end</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="9632187426-16">{</span><span class="ss">&#39;DOWN&#39;</span><span class="p">,</span><span class="mi">19355</span><span class="p">,</span><span class="ss">process</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.334</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="p" data-group-id="9632187426-17">{</span><span class="ss">exit_status</span><span class="p">,</span><span class="mi">10</span><span class="p" data-group-id="9632187426-17">}</span><span class="p" data-group-id="9632187426-16">}</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">21</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">file</span><span class="p">:</span><span class="nf">delete</span><span class="p" data-group-id="9632187426-18">(</span><span class="s">&quot;/tmp/pid&quot;</span><span class="p" data-group-id="9632187426-18">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span></code></pre><h3 id="specifying-a-custom-process-shutdown-delay-in-seconds" class="section-heading">
  <a href="#specifying-a-custom-process-shutdown-delay-in-seconds" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">specifying-a-custom-process-shutdown-delay-in-seconds</p>
  </a>
  Specifying a custom process shutdown delay in seconds
</h3>
<pre><code class="makeup erlang" translate="no"><span class="c1">% Execute an OS process (script) that blocks SIGTERM with custom kill timeout, and monitor</span><span class="w">
</span><span class="mi">22</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="6040776485-1">(</span><span class="n">I</span><span class="p" data-group-id="6040776485-1">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6040776485-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p" data-group-id="6040776485-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="6040776485-3">(</span><span class="s">&quot;trap &#39;&#39; SIGTERM; sleep 30&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6040776485-4">[</span><span class="p" data-group-id="6040776485-5">{</span><span class="ss">kill_timeout</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p" data-group-id="6040776485-5">}</span><span class="p">,</span><span class="w"> </span><span class="nb">monitor</span><span class="p" data-group-id="6040776485-4">]</span><span class="p" data-group-id="6040776485-3">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="6040776485-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.399</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">26347</span><span class="p" data-group-id="6040776485-6">}</span><span class="w">
</span><span class="c1">% Attempt to stop the OS process</span><span class="w">
</span><span class="mi">23</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="6040776485-7">(</span><span class="n">I</span><span class="p" data-group-id="6040776485-7">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="c1">% Wait for its completion</span><span class="w">
</span><span class="mi">24</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="6040776485-8">(</span><span class="n">M</span><span class="p" data-group-id="6040776485-8">)</span><span class="p">,</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="mi">10000</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">timeout</span><span class="w"> </span><span class="k">end</span><span class="p">.</span><span class="w">                                          
</span><span class="p" data-group-id="6040776485-9">{</span><span class="ss">&#39;DOWN&#39;</span><span class="p">,</span><span class="mi">26347</span><span class="p">,</span><span class="ss">process</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.403</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="ss">normal</span><span class="p" data-group-id="6040776485-9">}</span></code></pre><h3 id="specifying-a-custom-kill-command-for-a-process" class="section-heading">
  <a href="#specifying-a-custom-kill-command-for-a-process" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">specifying-a-custom-kill-command-for-a-process</p>
  </a>
  Specifying a custom kill command for a process
</h3>
<pre><code class="makeup erlang" translate="no"><span class="c1">% Execute an OS process (script) that blocks SIGTERM, and uses a custom kill command,</span><span class="w">
</span><span class="c1">% which kills it with a SIGINT. Add a monitor so that we can wait for process exit</span><span class="w">
</span><span class="c1">% notification. Note the use of the special environment variable &quot;CHILD_PID&quot; by the</span><span class="w">
</span><span class="c1">% kill command. This environment variable is set by the port program before invoking</span><span class="w">
</span><span class="c1">% the kill command:</span><span class="w">
</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="6511238422-1">(</span><span class="n">I</span><span class="p" data-group-id="6511238422-1">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6511238422-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p" data-group-id="6511238422-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="6511238422-3">(</span><span class="s">&quot;trap &#39;&#39; SIGTERM; sleep 30&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6511238422-4">[</span><span class="p" data-group-id="6511238422-5">{</span><span class="ss">kill</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;kill -n 2 ${CHILD_PID}&quot;</span><span class="p" data-group-id="6511238422-5">}</span><span class="p">,</span><span class="w">
                                                             </span><span class="p" data-group-id="6511238422-6">{</span><span class="ss">kill_timeout</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="6511238422-6">}</span><span class="p">,</span><span class="w"> </span><span class="nb">monitor</span><span class="p" data-group-id="6511238422-4">]</span><span class="p" data-group-id="6511238422-3">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="6511238422-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.399</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">26347</span><span class="p" data-group-id="6511238422-7">}</span><span class="w">
</span><span class="c1">% Try to kill by SIGTERM. This does nothing, since the process is blocking SIGTERM:</span><span class="w">
</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">kill</span><span class="p" data-group-id="6511238422-8">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="ss">sigterm</span><span class="p" data-group-id="6511238422-8">)</span><span class="p">,</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="6511238422-9">(</span><span class="n">M</span><span class="p" data-group-id="6511238422-9">)</span><span class="p">,</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">timeout</span><span class="w"> </span><span class="k">end</span><span class="p">.</span><span class="w">
</span><span class="ss">timeout</span><span class="w">
</span><span class="c1">% Attempt to stop the OS process</span><span class="w">
</span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="6511238422-10">(</span><span class="n">I</span><span class="p" data-group-id="6511238422-10">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="c1">% Wait for its completion</span><span class="w">
</span><span class="mi">5</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="6511238422-11">(</span><span class="n">M</span><span class="p" data-group-id="6511238422-11">)</span><span class="p">,</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">timeout</span><span class="w"> </span><span class="k">end</span><span class="p">.</span><span class="w">                                          
</span><span class="p" data-group-id="6511238422-12">{</span><span class="ss">&#39;DOWN&#39;</span><span class="p">,</span><span class="mi">26347</span><span class="p">,</span><span class="ss">process</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.403</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="ss">normal</span><span class="p" data-group-id="6511238422-12">}</span></code></pre><h3 id="communicating-with-an-os-process-via-stdin" class="section-heading">
  <a href="#communicating-with-an-os-process-via-stdin" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">communicating-with-an-os-process-via-stdin</p>
  </a>
  Communicating with an OS process via STDIN
</h3>
<pre><code class="makeup erlang" translate="no"><span class="c1">% Execute an OS process (script) that reads STDIN and echoes it back to Erlang</span><span class="w">
</span><span class="mi">25</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="7167460305-1">(</span><span class="n">I</span><span class="p" data-group-id="7167460305-1">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7167460305-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p" data-group-id="7167460305-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="7167460305-3">(</span><span class="s">&quot;read x; echo \&quot;Got: $x\&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7167460305-4">[</span><span class="ss">stdin</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="nb">monitor</span><span class="p" data-group-id="7167460305-4">]</span><span class="p" data-group-id="7167460305-3">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="7167460305-5">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.427</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">26431</span><span class="p" data-group-id="7167460305-5">}</span><span class="w">
</span><span class="c1">% Send the OS process some data via its stdin</span><span class="w">
</span><span class="mi">26</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="7167460305-6">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;Test data\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="7167460305-6">)</span><span class="p">.</span><span class="w">                                                  
</span><span class="ss">ok</span><span class="w">
</span><span class="c1">% Get the response written to processes stdout</span><span class="w">
</span><span class="mi">27</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="7167460305-7">(</span><span class="n">M</span><span class="p" data-group-id="7167460305-7">)</span><span class="p">,</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="mi">10000</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">timeout</span><span class="w"> </span><span class="k">end</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="7167460305-8">{</span><span class="ss">stdout</span><span class="p">,</span><span class="mi">26431</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;Got: Test data\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="7167460305-8">}</span><span class="w">
</span><span class="c1">% Confirm that the process exited</span><span class="w">
</span><span class="mi">28</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="7167460305-9">(</span><span class="n">M</span><span class="p" data-group-id="7167460305-9">)</span><span class="p">,</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="mi">10000</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">timeout</span><span class="w"> </span><span class="k">end</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="7167460305-10">{</span><span class="ss">&#39;DOWN&#39;</span><span class="p">,</span><span class="mi">26431</span><span class="p">,</span><span class="ss">process</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.427</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="ss">normal</span><span class="p" data-group-id="7167460305-10">}</span></code></pre><h3 id="communicating-with-an-os-process-via-stdin-and-sending-end-of-file" class="section-heading">
  <a href="#communicating-with-an-os-process-via-stdin-and-sending-end-of-file" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">communicating-with-an-os-process-via-stdin-and-sending-end-of-file</p>
  </a>
  Communicating with an OS process via STDIN and sending end-of-file
</h3>
<pre><code class="makeup erlang" translate="no"><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Watcher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">spawn</span><span class="p" data-group-id="2385134313-1">(</span><span class="k">fun</span><span class="w"> </span><span class="n">F</span><span class="p" data-group-id="2385134313-2">(</span><span class="p" data-group-id="2385134313-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">Msg</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="2385134313-3">(</span><span class="s">&quot;Got: </span><span class="si">~p</span><span class="s">\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2385134313-4">[</span><span class="n">Msg</span><span class="p" data-group-id="2385134313-4">]</span><span class="p" data-group-id="2385134313-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p" data-group-id="2385134313-5">(</span><span class="p" data-group-id="2385134313-5">)</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="mi">60000</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">ok</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">end</span><span class="p" data-group-id="2385134313-1">)</span><span class="p">.</span><span class="w">
</span><span class="o">&lt;</span><span class="mf">0.112</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="w">
</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="2385134313-6">(</span><span class="n">Pid</span><span class="p" data-group-id="2385134313-6">)</span><span class="p">,</span><span class="w"> </span><span class="nf">f</span><span class="p" data-group-id="2385134313-7">(</span><span class="n">OsPid</span><span class="p" data-group-id="2385134313-7">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2385134313-8">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Pid</span><span class="p">,</span><span class="w"> </span><span class="n">OsPid</span><span class="p" data-group-id="2385134313-8">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="2385134313-9">(</span><span class="s">&quot;tac&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2385134313-10">[</span><span class="ss">stdin</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2385134313-11">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="n">Watcher</span><span class="p" data-group-id="2385134313-11">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2385134313-12">{</span><span class="ss">stderr</span><span class="p">,</span><span class="w"> </span><span class="n">Watcher</span><span class="p" data-group-id="2385134313-12">}</span><span class="p" data-group-id="2385134313-10">]</span><span class="p" data-group-id="2385134313-9">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="2385134313-13">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.114</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">26143</span><span class="p" data-group-id="2385134313-13">}</span><span class="w">
</span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="2385134313-14">(</span><span class="n">Pid</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;foo\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="2385134313-14">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">5</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="2385134313-15">(</span><span class="n">Pid</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;bar\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="2385134313-15">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">6</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="2385134313-16">(</span><span class="n">Pid</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;baz\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="2385134313-16">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">7</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="2385134313-17">(</span><span class="n">Pid</span><span class="p">,</span><span class="w"> </span><span class="ss">eof</span><span class="p" data-group-id="2385134313-17">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="n">Got</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="2385134313-18">{</span><span class="ss">stdout</span><span class="p">,</span><span class="mi">26143</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;baz\nbar\nfoo\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="2385134313-18">}</span></code></pre><h3 id="running-os-commands-synchronously" class="section-heading">
  <a href="#running-os-commands-synchronously" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">running-os-commands-synchronously</p>
  </a>
  Running OS commands synchronously
</h3>
<pre><code class="makeup erlang" translate="no"><span class="c1">% Execute an shell script that blocks for 1 second and return its termination code</span><span class="w">
</span><span class="mi">29</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="5741385359-1">(</span><span class="s">&quot;sleep 1; echo Test&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5741385359-2">[</span><span class="ss">sync</span><span class="p" data-group-id="5741385359-2">]</span><span class="p" data-group-id="5741385359-1">)</span><span class="p">.</span><span class="w">
</span><span class="c1">% By default all I/O is redirected to /dev/null, so no output is captured</span><span class="w">
</span><span class="p" data-group-id="5741385359-3">{</span><span class="ss">ok</span><span class="p">,</span><span class="p" data-group-id="5741385359-4">[</span><span class="p" data-group-id="5741385359-4">]</span><span class="p" data-group-id="5741385359-3">}</span><span class="w">

</span><span class="c1">% &#39;stdout&#39; option instructs the port program to capture stdout and return it to caller</span><span class="w">
</span><span class="mi">30</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="5741385359-5">(</span><span class="s">&quot;sleep 1; echo Test&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5741385359-6">[</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="ss">sync</span><span class="p" data-group-id="5741385359-6">]</span><span class="p" data-group-id="5741385359-5">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="5741385359-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="p" data-group-id="5741385359-8">[</span><span class="p" data-group-id="5741385359-9">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5741385359-10">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;Test\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="5741385359-10">]</span><span class="p" data-group-id="5741385359-9">}</span><span class="p" data-group-id="5741385359-8">]</span><span class="p" data-group-id="5741385359-7">}</span><span class="w">

</span><span class="c1">% Execute a non-existing command</span><span class="w">
</span><span class="mi">31</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="5741385359-11">(</span><span class="s">&quot;echo1 Test&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5741385359-12">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="ss">stderr</span><span class="p" data-group-id="5741385359-12">]</span><span class="p" data-group-id="5741385359-11">)</span><span class="p">.</span><span class="w">   
</span><span class="p" data-group-id="5741385359-13">{</span><span class="ss">error</span><span class="p">,</span><span class="p" data-group-id="5741385359-14">[</span><span class="p" data-group-id="5741385359-15">{</span><span class="ss">exit_status</span><span class="p">,</span><span class="mi">32512</span><span class="p" data-group-id="5741385359-15">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="5741385359-16">{</span><span class="ss">stderr</span><span class="p">,</span><span class="p" data-group-id="5741385359-17">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;/bin/bash: echo1: command not found\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="5741385359-17">]</span><span class="p" data-group-id="5741385359-16">}</span><span class="p" data-group-id="5741385359-14">]</span><span class="p" data-group-id="5741385359-13">}</span><span class="w">

</span><span class="c1">% Capture stdout/stderr of the executed command</span><span class="w">
</span><span class="mi">32</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="5741385359-18">(</span><span class="s">&quot;echo Test; echo Err 1&gt;&amp;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5741385359-19">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="ss">stderr</span><span class="p" data-group-id="5741385359-19">]</span><span class="p" data-group-id="5741385359-18">)</span><span class="p">.</span><span class="w">    
</span><span class="p" data-group-id="5741385359-20">{</span><span class="ss">ok</span><span class="p">,</span><span class="p" data-group-id="5741385359-21">[</span><span class="p" data-group-id="5741385359-22">{</span><span class="ss">stdout</span><span class="p">,</span><span class="p" data-group-id="5741385359-23">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;Test\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="5741385359-23">]</span><span class="p" data-group-id="5741385359-22">}</span><span class="p">,</span><span class="p" data-group-id="5741385359-24">{</span><span class="ss">stderr</span><span class="p">,</span><span class="p" data-group-id="5741385359-25">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;Err\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="5741385359-25">]</span><span class="p" data-group-id="5741385359-24">}</span><span class="p" data-group-id="5741385359-21">]</span><span class="p" data-group-id="5741385359-20">}</span><span class="w">

</span><span class="c1">% Redirect stderr to stdout</span><span class="w">
</span><span class="mi">33</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="5741385359-26">(</span><span class="s">&quot;echo Test 1&gt;&amp;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5741385359-27">[</span><span class="p" data-group-id="5741385359-28">{</span><span class="ss">stderr</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p" data-group-id="5741385359-28">}</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="ss">sync</span><span class="p" data-group-id="5741385359-27">]</span><span class="p" data-group-id="5741385359-26">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="5741385359-29">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5741385359-30">[</span><span class="p" data-group-id="5741385359-31">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5741385359-32">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;Test\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="5741385359-32">]</span><span class="p" data-group-id="5741385359-31">}</span><span class="p" data-group-id="5741385359-30">]</span><span class="p" data-group-id="5741385359-29">}</span></code></pre><h3 id="running-os-commands-with-without-shell" class="section-heading">
  <a href="#running-os-commands-with-without-shell" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">running-os-commands-with-without-shell</p>
  </a>
  Running OS commands with/without shell
</h3>
<pre><code class="makeup erlang" translate="no"><span class="c1">% Execute a command by an OS shell interpreter</span><span class="w">
</span><span class="mi">34</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="4837801992-1">(</span><span class="s">&quot;/bin/echo ok&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4837801992-2">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p" data-group-id="4837801992-2">]</span><span class="p" data-group-id="4837801992-1">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="4837801992-3">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4837801992-4">[</span><span class="p" data-group-id="4837801992-5">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4837801992-6">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;ok\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="4837801992-6">]</span><span class="p" data-group-id="4837801992-5">}</span><span class="p" data-group-id="4837801992-4">]</span><span class="p" data-group-id="4837801992-3">}</span><span class="w">

</span><span class="c1">% Execute an executable without a shell</span><span class="w">
</span><span class="mi">35</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="4837801992-7">(</span><span class="p" data-group-id="4837801992-8">[</span><span class="s">&quot;/bin/echo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ok&quot;</span><span class="p" data-group-id="4837801992-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4837801992-9">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p" data-group-id="4837801992-9">]</span><span class="p" data-group-id="4837801992-7">)</span><span class="p">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="4837801992-10">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4837801992-11">[</span><span class="p" data-group-id="4837801992-12">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4837801992-13">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;ok\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="4837801992-13">]</span><span class="p" data-group-id="4837801992-12">}</span><span class="p" data-group-id="4837801992-11">]</span><span class="p" data-group-id="4837801992-10">}</span><span class="w">

</span><span class="c1">% Execute a shell with custom options</span><span class="w">
</span><span class="mi">36</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="4837801992-14">(</span><span class="p" data-group-id="4837801992-15">[</span><span class="s">&quot;/bin/bash&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;-c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;echo ok&quot;</span><span class="p" data-group-id="4837801992-15">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4837801992-16">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p" data-group-id="4837801992-16">]</span><span class="p" data-group-id="4837801992-14">)</span><span class="p">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="4837801992-17">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4837801992-18">[</span><span class="p" data-group-id="4837801992-19">{</span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4837801992-20">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;ok\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="4837801992-20">]</span><span class="p" data-group-id="4837801992-19">}</span><span class="p" data-group-id="4837801992-18">]</span><span class="p" data-group-id="4837801992-17">}</span></code></pre><h3 id="running-os-commands-with-pseudo-terminal-pty" class="section-heading">
  <a href="#running-os-commands-with-pseudo-terminal-pty" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">running-os-commands-with-pseudo-terminal-pty</p>
  </a>
  Running OS commands with pseudo terminal (pty)
</h3>
<pre><code class="makeup erlang" translate="no"><span class="c1">% Execute a command without a pty</span><span class="w">
</span><span class="mi">37</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="8076730716-1">(</span><span class="s">&quot;echo hello&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8076730716-2">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p" data-group-id="8076730716-2">]</span><span class="p" data-group-id="8076730716-1">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8076730716-3">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8076730716-4">[</span><span class="p" data-group-id="8076730716-5">{</span><span class="ss">stdout</span><span class="p">,</span><span class="p" data-group-id="8076730716-6">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;hello\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-6">]</span><span class="p" data-group-id="8076730716-5">}</span><span class="p" data-group-id="8076730716-4">]</span><span class="p" data-group-id="8076730716-3">}</span><span class="w">

</span><span class="c1">% Execute a command with a pty</span><span class="w">
</span><span class="mi">38</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="8076730716-7">(</span><span class="s">&quot;echo hello&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8076730716-8">[</span><span class="ss">sync</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="ss">pty</span><span class="p" data-group-id="8076730716-8">]</span><span class="p" data-group-id="8076730716-7">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8076730716-9">{</span><span class="ss">ok</span><span class="p">,</span><span class="p" data-group-id="8076730716-10">[</span><span class="p" data-group-id="8076730716-11">{</span><span class="ss">stdout</span><span class="p">,</span><span class="p" data-group-id="8076730716-12">[</span><span class="p">&lt;&lt;</span><span class="s">&quot;hello&quot;</span><span class="p">&gt;&gt;</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;\r\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-12">]</span><span class="p" data-group-id="8076730716-11">}</span><span class="p" data-group-id="8076730716-10">]</span><span class="p" data-group-id="8076730716-9">}</span><span class="w">

</span><span class="c1">% Execute a command with pty echo</span><span class="w">
</span><span class="mi">39</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="8076730716-13">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">P0</span><span class="p">,</span><span class="w"> </span><span class="n">I0</span><span class="p" data-group-id="8076730716-13">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="8076730716-14">(</span><span class="s">&quot;cat&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8076730716-15">[</span><span class="ss">stdin</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8076730716-16">{</span><span class="ss">stderr</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p" data-group-id="8076730716-16">}</span><span class="p">,</span><span class="w"> </span><span class="ss">pty</span><span class="p">,</span><span class="w"> </span><span class="ss">pty_echo</span><span class="p" data-group-id="8076730716-15">]</span><span class="p" data-group-id="8076730716-14">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8076730716-17">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.162</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">17086</span><span class="p" data-group-id="8076730716-17">}</span><span class="w">
</span><span class="mi">40</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="8076730716-18">(</span><span class="n">I0</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;hello&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-18">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">41</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">flush</span><span class="p" data-group-id="8076730716-19">(</span><span class="p" data-group-id="8076730716-19">)</span><span class="p">.</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="8076730716-20">{</span><span class="ss">stdout</span><span class="p">,</span><span class="mi">17086</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;hello&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-20">}</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">42</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="8076730716-21">(</span><span class="n">I0</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-21">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">43</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">flush</span><span class="p" data-group-id="8076730716-22">(</span><span class="p" data-group-id="8076730716-22">)</span><span class="p">.</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="8076730716-23">{</span><span class="ss">stdout</span><span class="p">,</span><span class="mi">17086</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;\r\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-23">}</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="8076730716-24">{</span><span class="ss">stdout</span><span class="p">,</span><span class="mi">17086</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;hello\r\n&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-24">}</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">44</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="8076730716-25">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="mi">3</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-25">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">45</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">flush</span><span class="p" data-group-id="8076730716-26">(</span><span class="p" data-group-id="8076730716-26">)</span><span class="p">.</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="8076730716-27">{</span><span class="ss">stdout</span><span class="p">,</span><span class="mi">17086</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="s">&quot;^C&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-27">}</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="8076730716-28">{</span><span class="ss">&#39;DOWN&#39;</span><span class="p">,</span><span class="mi">17086</span><span class="p">,</span><span class="ss">process</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.162</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="p" data-group-id="8076730716-29">{</span><span class="ss">exit_status</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="8076730716-29">}</span><span class="p" data-group-id="8076730716-28">}</span><span class="w">
</span><span class="ss">ok</span><span class="w">

</span><span class="c1">% Execute a command with custom pty options</span><span class="w">
</span><span class="mi">46</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="8076730716-30">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">P1</span><span class="p">,</span><span class="w"> </span><span class="n">I1</span><span class="p" data-group-id="8076730716-30">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="8076730716-31">(</span><span class="s">&quot;cat&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8076730716-32">[</span><span class="ss">stdin</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8076730716-33">{</span><span class="ss">stderr</span><span class="p">,</span><span class="w"> </span><span class="ss">stdout</span><span class="p" data-group-id="8076730716-33">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8076730716-34">{</span><span class="ss">pty</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8076730716-35">[</span><span class="p" data-group-id="8076730716-36">{</span><span class="ss">vintr</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="8076730716-36">}</span><span class="p" data-group-id="8076730716-35">]</span><span class="p" data-group-id="8076730716-34">}</span><span class="p">,</span><span class="w"> </span><span class="nb">monitor</span><span class="p" data-group-id="8076730716-32">]</span><span class="p" data-group-id="8076730716-31">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8076730716-37">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.199</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">16662</span><span class="p" data-group-id="8076730716-37">}</span><span class="w">
</span><span class="mi">47</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="8076730716-38">(</span><span class="n">I1</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="mi">3</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-38">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">48</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">flush</span><span class="p" data-group-id="8076730716-39">(</span><span class="p" data-group-id="8076730716-39">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">49</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="8076730716-40">(</span><span class="n">I1</span><span class="p">,</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="mi">2</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="8076730716-40">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="w">
</span><span class="mi">50</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">flush</span><span class="p" data-group-id="8076730716-41">(</span><span class="p" data-group-id="8076730716-41">)</span><span class="p">.</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="8076730716-42">{</span><span class="ss">&#39;DOWN&#39;</span><span class="p">,</span><span class="mi">16662</span><span class="p">,</span><span class="ss">process</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.199</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="p" data-group-id="8076730716-43">{</span><span class="ss">exit_status</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="8076730716-43">}</span><span class="p" data-group-id="8076730716-42">}</span><span class="w">
</span><span class="ss">ok</span></code></pre><h3 id="kill-a-process-group-at-process-exit" class="section-heading">
  <a href="#kill-a-process-group-at-process-exit" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">kill-a-process-group-at-process-exit</p>
  </a>
  Kill a process group at process exit
</h3>
<pre><code class="makeup erlang" translate="no"><span class="c1">% In the following scenario the process P0 will create a new process group</span><span class="w">
</span><span class="c1">% equal to the OS pid of that process (value = GID). The next two commands</span><span class="w">
</span><span class="c1">% are assigned to the same process group GID. As soon as the P0 process exits</span><span class="w">
</span><span class="c1">% P1 and P2 will also get terminated by signal 15 (SIGTERM):</span><span class="w">
</span><span class="mi">51</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="3432010671-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">P2</span><span class="p">,</span><span class="w"> </span><span class="n">GID</span><span class="p" data-group-id="3432010671-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="3432010671-2">(</span><span class="s">&quot;sleep 10&quot;</span><span class="p">,</span><span class="w">  </span><span class="p" data-group-id="3432010671-3">[</span><span class="p" data-group-id="3432010671-4">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="3432010671-4">}</span><span class="p">,</span><span class="w">   </span><span class="ss">kill_group</span><span class="p" data-group-id="3432010671-3">]</span><span class="p" data-group-id="3432010671-2">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="3432010671-5">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.37</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">25306</span><span class="p" data-group-id="3432010671-5">}</span><span class="w">
</span><span class="mi">52</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="3432010671-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">P3</span><span class="p">,</span><span class="w">   </span><span class="p">_</span><span class="p" data-group-id="3432010671-6">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="3432010671-7">(</span><span class="s">&quot;sleep 15&quot;</span><span class="p">,</span><span class="w">  </span><span class="p" data-group-id="3432010671-8">[</span><span class="p" data-group-id="3432010671-9">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="n">GID</span><span class="p" data-group-id="3432010671-9">}</span><span class="p">,</span><span class="w"> </span><span class="nb">monitor</span><span class="p" data-group-id="3432010671-8">]</span><span class="p" data-group-id="3432010671-7">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="3432010671-10">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.39</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">25307</span><span class="p" data-group-id="3432010671-10">}</span><span class="w">
</span><span class="mi">53</span><span class="o">&gt;</span><span class="w"> </span><span class="p" data-group-id="3432010671-11">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">P4</span><span class="p">,</span><span class="w">   </span><span class="p">_</span><span class="p" data-group-id="3432010671-11">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">exec</span><span class="p">:</span><span class="nf">run</span><span class="p" data-group-id="3432010671-12">(</span><span class="s">&quot;sleep 15&quot;</span><span class="p">,</span><span class="w">  </span><span class="p" data-group-id="3432010671-13">[</span><span class="p" data-group-id="3432010671-14">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="n">GID</span><span class="p" data-group-id="3432010671-14">}</span><span class="p">,</span><span class="w"> </span><span class="nb">monitor</span><span class="p" data-group-id="3432010671-13">]</span><span class="p" data-group-id="3432010671-12">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="3432010671-15">{</span><span class="ss">ok</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.41</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="mi">25308</span><span class="p" data-group-id="3432010671-15">}</span><span class="w">
</span><span class="mi">54</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">flush</span><span class="p" data-group-id="3432010671-16">(</span><span class="p" data-group-id="3432010671-16">)</span><span class="p">.</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="3432010671-17">{</span><span class="ss">&#39;DOWN&#39;</span><span class="p">,</span><span class="mi">25307</span><span class="p">,</span><span class="ss">process</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.39</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="p" data-group-id="3432010671-18">{</span><span class="ss">exit_status</span><span class="p">,</span><span class="mi">15</span><span class="p" data-group-id="3432010671-18">}</span><span class="p" data-group-id="3432010671-17">}</span><span class="w">
</span><span class="n">Shell</span><span class="w"> </span><span class="ss">got</span><span class="w"> </span><span class="p" data-group-id="3432010671-19">{</span><span class="ss">&#39;DOWN&#39;</span><span class="p">,</span><span class="mi">25308</span><span class="p">,</span><span class="ss">process</span><span class="p">,</span><span class="o">&lt;</span><span class="mf">0.41</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span><span class="p" data-group-id="3432010671-20">{</span><span class="ss">exit_status</span><span class="p">,</span><span class="mi">15</span><span class="p" data-group-id="3432010671-20">}</span><span class="p" data-group-id="3432010671-19">}</span><span class="w">
</span><span class="ss">ok</span></code></pre>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="api-reference.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
API Reference
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="license.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
License
        </span>
      </a>

  </div>
</div>
      <footer class="footer">

          <p>
            On Hex.pm:

            <span class="line">
              <a href="https://hex.pm/packages/erlexec/2.0.1" class="line footer-hex-package">Package</a>
              <a href="https://preview.hex.pm/preview/erlexec/2.0.1" class="line">Preview</a>

                <a href="https://preview.hex.pm/preview/erlexec/2.0.1/show/README.md">(current file)</a>

            </span>

            <button class="a-main line footer-button display-quick-switch">
              Search
            </button>
          </p>

        <p>
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.29.0) for the

            <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
